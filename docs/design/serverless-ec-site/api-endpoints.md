# serverless-ec-site API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä»•æ§˜

**ä½œæˆæ—¥**: 2026-01-11
**é–¢é€£è¨­è¨ˆ**: [architecture.md](architecture.md)
**é–¢é€£è¦ä»¶å®šç¾©**: [requirements.md](../../spec/serverless-ec-site/requirements.md)

**ã€ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«å‡¡ä¾‹ã€‘**:

- ğŸ”µ **é’ä¿¡å·**: ã‚¿ã‚¹ã‚¯ãƒãƒ¼ãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ã‚’å‚è€ƒã«ã—ãŸç¢ºå®Ÿãªå®šç¾©
- ğŸŸ¡ **é»„ä¿¡å·**: ã‚¿ã‚¹ã‚¯ãƒãƒ¼ãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬ã«ã‚ˆã‚‹å®šç¾©
- ğŸ”´ **èµ¤ä¿¡å·**: ã‚¿ã‚¹ã‚¯ãƒãƒ¼ãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ã«ãªã„æ¨æ¸¬ã«ã‚ˆã‚‹å®šç¾©

---

## å…±é€šä»•æ§˜

### ãƒ™ãƒ¼ã‚¹URL ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆã‚ˆã‚Š*

```text
https://{cloudfront-domain}/api/v1
```

### èªè¨¼ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆãƒ»Cognitoé¸æŠã‚ˆã‚Š*

èªè¨¼ãŒå¿…è¦ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã« Cognito JWT ã‚’å«ã‚ã‚‹ã€‚

```http
Authorization: Bearer {id_token}
```

### ã‚²ã‚¹ãƒˆè­˜åˆ¥ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆã‚²ã‚¹ãƒˆè³¼å…¥ï¼‰ã‚ˆã‚Š*

ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ X-Guest-ID ãƒ˜ãƒƒãƒ€ãƒ¼ã§è­˜åˆ¥ã™ã‚‹ã€‚

```http
X-Guest-ID: {uuid}
```

### å¤šè¨€èªå¯¾å¿œ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆå¤šè¨€èªï¼‰ã‚ˆã‚Š*

Accept-Language ãƒ˜ãƒƒãƒ€ãƒ¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨€èªã‚’æŒ‡å®šã€‚

```http
Accept-Language: ja | en | ko
```

### ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å…±é€šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ä¸€èˆ¬çš„ãªAPIè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³*

```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
    "details": {}
  }
}
```

### ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ä¸€èˆ¬çš„ãªAPIè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³*

ãƒªã‚¹ãƒˆã‚’è¿”ã™ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã€‚

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `page`: ãƒšãƒ¼ã‚¸ç•ªå·ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1ï¼‰
- `limit`: 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20ã€æœ€å¤§: 100ï¼‰

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼**:

```json
{
  "success": true,
  "data": [...],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

---

## ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

### èªè¨¼ API

#### POST /api/v1/auth/signup ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: ä¼šå“¡ç™»éŒ²

**èªè¨¼**: ä¸è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "email": "user@example.com",
  "password": "Password123!",
  "name": "å±±ç”° å¤ªéƒ",
  "locale": "ja"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "message": "ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ",
    "email": "user@example.com"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `EMAIL_ALREADY_EXISTS`: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ—¢ã«ç™»éŒ²æ¸ˆã¿
- `INVALID_PASSWORD`: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼é•å
- `VALIDATION_ERROR`: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

---

#### POST /api/v1/auth/confirm ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *Cognitoä»•æ§˜ã‚ˆã‚Š*

**èª¬æ˜**: ãƒ¡ãƒ¼ãƒ«ç¢ºèªã‚³ãƒ¼ãƒ‰æ¤œè¨¼

**èªè¨¼**: ä¸è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "email": "user@example.com",
  "code": "123456"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "message": "ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `INVALID_CODE`: ç¢ºèªã‚³ãƒ¼ãƒ‰ãŒç„¡åŠ¹
- `CODE_EXPIRED`: ç¢ºèªã‚³ãƒ¼ãƒ‰ãŒæœŸé™åˆ‡ã‚Œ
- `USER_NOT_FOUND`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„

---

#### POST /api/v1/auth/login ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: ãƒ­ã‚°ã‚¤ãƒ³

**èªè¨¼**: ä¸è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "email": "user@example.com",
  "password": "Password123!"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "accessToken": "eyJhbGciOiJSUzI1NiIs...",
    "refreshToken": "eyJjdHkiOiJKV1QiLCJl...",
    "idToken": "eyJhbGciOiJSUzI1NiIs...",
    "expiresIn": 3600,
    "user": {
      "id": "user-uuid",
      "email": "user@example.com",
      "name": "å±±ç”° å¤ªéƒ",
      "locale": "ja"
    }
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `INVALID_CREDENTIALS`: èªè¨¼æƒ…å ±ãŒç„¡åŠ¹
- `USER_NOT_CONFIRMED`: ãƒ¡ãƒ¼ãƒ«æœªç¢ºèª
- `ACCOUNT_DISABLED`: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç„¡åŠ¹

---

#### POST /api/v1/auth/logout ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *èªè¨¼æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

**èªè¨¼**: å¿…è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: ãªã—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true
}
```

---

#### POST /api/v1/auth/refresh ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *Cognitoä»•æ§˜ã‚ˆã‚Š*

**èª¬æ˜**: ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥

**èªè¨¼**: ä¸è¦ï¼ˆrefreshTokenä½¿ç”¨ï¼‰

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "refreshToken": "eyJjdHkiOiJKV1QiLCJl..."
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "accessToken": "eyJhbGciOiJSUzI1NiIs...",
    "idToken": "eyJhbGciOiJSUzI1NiIs...",
    "expiresIn": 3600
  }
}
```

---

#### GET /api/v1/auth/social/{provider} ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³é–‹å§‹ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰

**èªè¨¼**: ä¸è¦

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `provider`: `google` | `facebook`

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: Cognito Hosted UI ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

---

### å•†å“ API

#### GET /api/v1/categories ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆå•†å“ã‚«ã‚¿ãƒ­ã‚°ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ†ã‚´ãƒªä¸€è¦§å–å¾—

**èªè¨¼**: ä¸è¦

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": [
    {
      "id": "category-uuid",
      "name": {
        "ja": "ã‚¢ãƒ‘ãƒ¬ãƒ«",
        "en": "Apparel",
        "ko": "ì˜ë¥˜"
      },
      "slug": "apparel",
      "parentId": null,
      "displayOrder": 1,
      "imageUrl": "https://..."
    }
  ]
}
```

---

#### GET /api/v1/products ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆå•†å“ã‚«ã‚¿ãƒ­ã‚°ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: å•†å“ä¸€è¦§å–å¾—

**èªè¨¼**: ä¸è¦

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `categoryId` (optional): ã‚«ãƒ†ã‚´ãƒªID
- `page` (optional): ãƒšãƒ¼ã‚¸ç•ªå·
- `limit` (optional): ä»¶æ•°
- `sortBy` (optional): `price` | `createdAt` | `name`
- `sortOrder` (optional): `asc` | `desc`

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": [
    {
      "id": "product-uuid",
      "sku": "SKU-001",
      "name": {
        "ja": "å•†å“å",
        "en": "Product Name",
        "ko": "ìƒí’ˆëª…"
      },
      "description": {
        "ja": "å•†å“èª¬æ˜",
        "en": "Product Description",
        "ko": "ìƒí’ˆ ì„¤ëª…"
      },
      "price": 1980,
      "compareAtPrice": 2500,
      "currency": "JPY",
      "categoryId": "category-uuid",
      "images": [
        {
          "id": "image-uuid",
          "url": "https://...",
          "alt": { "ja": "...", "en": "...", "ko": "..." },
          "displayOrder": 1,
          "isMain": true
        }
      ],
      "stock": 100,
      "isActive": true
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 150,
    "totalPages": 8
  }
}
```

---

#### GET /api/v1/products/:id ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *å•†å“ã‚«ã‚¿ãƒ­ã‚°ã‚ˆã‚Š*

**èª¬æ˜**: å•†å“è©³ç´°å–å¾—

**èªè¨¼**: ä¸è¦

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `id`: å•†å“ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "id": "product-uuid",
    "sku": "SKU-001",
    "name": { "ja": "...", "en": "...", "ko": "..." },
    "description": { "ja": "...", "en": "...", "ko": "..." },
    "price": 1980,
    "compareAtPrice": 2500,
    "currency": "JPY",
    "categoryId": "category-uuid",
    "images": [...],
    "stock": 100,
    "isActive": true,
    "attributes": [
      {
        "name": { "ja": "ã‚µã‚¤ã‚º", "en": "Size", "ko": "ì‚¬ì´ì¦ˆ" },
        "value": { "ja": "M", "en": "M", "ko": "M" }
      }
    ],
    "createdAt": "2026-01-01T00:00:00Z",
    "updatedAt": "2026-01-01T00:00:00Z"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `PRODUCT_NOT_FOUND`: å•†å“ãŒè¦‹ã¤ã‹ã‚‰ãªã„

---

#### GET /api/v1/products/search ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *å•†å“ã‚«ã‚¿ãƒ­ã‚°ã‚ˆã‚Š*

**èª¬æ˜**: å•†å“æ¤œç´¢

**èªè¨¼**: ä¸è¦

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `q`: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆå¿…é ˆï¼‰
- `categoryId` (optional): ã‚«ãƒ†ã‚´ãƒªID
- `minPrice` (optional): æœ€ä½ä¾¡æ ¼
- `maxPrice` (optional): æœ€é«˜ä¾¡æ ¼
- `page` (optional): ãƒšãƒ¼ã‚¸ç•ªå·
- `limit` (optional): ä»¶æ•°

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: GET /api/v1/products ã¨åŒå½¢å¼

---

### ã‚«ãƒ¼ãƒˆ API

#### GET /api/v1/cart ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆã‚«ãƒ¼ãƒˆãƒ»æ³¨æ–‡ï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ¼ãƒˆå–å¾—

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "id": "cart-uuid",
    "items": [
      {
        "productId": "product-uuid",
        "quantity": 2,
        "price": 1980,
        "product": {
          "id": "product-uuid",
          "name": { "ja": "...", "en": "...", "ko": "..." },
          "images": [...]
        }
      }
    ],
    "subtotal": 3960,
    "createdAt": "2026-01-01T00:00:00Z",
    "updatedAt": "2026-01-01T00:00:00Z"
  }
}
```

---

#### POST /api/v1/cart/items ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ¼ãƒˆã«ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "productId": "product-uuid",
  "quantity": 1
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: ã‚«ãƒ¼ãƒˆå…¨ä½“ã‚’è¿”å´ï¼ˆGET /api/v1/cart ã¨åŒå½¢å¼ï¼‰

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `PRODUCT_NOT_FOUND`: å•†å“ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- `OUT_OF_STOCK`: åœ¨åº«ä¸è¶³
- `VALIDATION_ERROR`: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

---

#### PUT /api/v1/cart/items/:productId ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ æ•°é‡æ›´æ–°

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `productId`: å•†å“ID

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "quantity": 3
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: ã‚«ãƒ¼ãƒˆå…¨ä½“ã‚’è¿”å´

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `ITEM_NOT_IN_CART`: ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚«ãƒ¼ãƒˆã«ãªã„
- `OUT_OF_STOCK`: åœ¨åº«ä¸è¶³

---

#### DELETE /api/v1/cart/items/:productId ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ¼ãƒˆã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `productId`: å•†å“ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: ã‚«ãƒ¼ãƒˆå…¨ä½“ã‚’è¿”å´

---

#### DELETE /api/v1/cart ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ã‚«ãƒ¼ãƒˆã‚’ç©ºã«ã™ã‚‹

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true
}
```

---

#### POST /api/v1/cart/merge ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ã‚²ã‚¹ãƒˆè³¼å…¥ã‹ã‚‰ã®å¦¥å½“ãªæ¨æ¸¬*

**èª¬æ˜**: ã‚²ã‚¹ãƒˆã‚«ãƒ¼ãƒˆã‚’ä¼šå“¡ã‚«ãƒ¼ãƒˆã«ãƒãƒ¼ã‚¸ï¼ˆãƒ­ã‚°ã‚¤ãƒ³æ™‚ï¼‰

**èªè¨¼**: å¿…è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "guestId": "guest-uuid"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: ãƒãƒ¼ã‚¸å¾Œã®ã‚«ãƒ¼ãƒˆå…¨ä½“ã‚’è¿”å´

---

### æ³¨æ–‡ API

#### POST /api/v1/orders ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆã‚«ãƒ¼ãƒˆãƒ»æ³¨æ–‡ã€æ±ºæ¸ˆï¼‰ã‚ˆã‚Š*

**èª¬æ˜**: æ³¨æ–‡ä½œæˆ

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "shippingAddressId": "address-uuid",
  "paymentMethod": "credit_card",
  "locale": "ja"
}
```

ã¾ãŸã¯ï¼ˆæ–°è¦ä½æ‰€å…¥åŠ›ãƒ»ã‚²ã‚¹ãƒˆè³¼å…¥ï¼‰:

```json
{
  "shippingAddress": {
    "name": "å±±ç”° å¤ªéƒ",
    "postalCode": "100-0001",
    "country": "JP",
    "prefecture": "æ±äº¬éƒ½",
    "city": "åƒä»£ç”°åŒº",
    "address1": "åƒä»£ç”°1-1-1",
    "address2": "ã€‡ã€‡ãƒ“ãƒ«101",
    "phone": "03-1234-5678"
  },
  "paymentMethod": "credit_card",
  "guestEmail": "guest@example.com",
  "locale": "ja"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸ - ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ï¼‰**:

```json
{
  "success": true,
  "data": {
    "orderId": "order-uuid",
    "orderNumber": "ORD-20260111-0001",
    "clientSecret": "pi_xxx_secret_xxx",
    "paymentMethod": "credit_card"
  }
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸ - ä»£å¼•ã/éŠ€è¡ŒæŒ¯è¾¼ï¼‰**:

```json
{
  "success": true,
  "data": {
    "orderId": "order-uuid",
    "orderNumber": "ORD-20260111-0001",
    "paymentMethod": "bank_transfer",
    "paymentInstructions": {
      "bankName": "â—‹â—‹éŠ€è¡Œ",
      "branchName": "â–³â–³æ”¯åº—",
      "accountType": "æ™®é€š",
      "accountNumber": "1234567",
      "accountHolder": "ã‚«ï¼‰â–¡â–¡â–¡â–¡"
    }
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `CART_EMPTY`: ã‚«ãƒ¼ãƒˆãŒç©º
- `OUT_OF_STOCK`: åœ¨åº«ä¸è¶³
- `INVALID_ADDRESS`: ä½æ‰€ãŒç„¡åŠ¹
- `PAYMENT_FAILED`: æ±ºæ¸ˆåˆæœŸåŒ–å¤±æ•—

---

#### PUT /api/v1/orders/:id/confirm ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *Stripeæ±ºæ¸ˆãƒ•ãƒ­ãƒ¼ã‚ˆã‚Š*

**èª¬æ˜**: æ³¨æ–‡ç¢ºå®šï¼ˆã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆæˆåŠŸå¾Œï¼‰

**èªè¨¼**: å¿…è¦ ã¾ãŸã¯ X-Guest-ID

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `id`: æ³¨æ–‡ID

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: ãªã—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "orderId": "order-uuid",
    "orderNumber": "ORD-20260111-0001",
    "status": "confirmed"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `ORDER_NOT_FOUND`: æ³¨æ–‡ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- `PAYMENT_NOT_COMPLETED`: æ±ºæ¸ˆæœªå®Œäº†
- `ORDER_ALREADY_CONFIRMED`: æ—¢ã«ç¢ºå®šæ¸ˆã¿

---

#### GET /api/v1/orders ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒã‚¤ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: æ³¨æ–‡å±¥æ­´å–å¾—

**èªè¨¼**: å¿…è¦

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `page` (optional): ãƒšãƒ¼ã‚¸ç•ªå·
- `limit` (optional): ä»¶æ•°
- `status` (optional): ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹çµã‚Šè¾¼ã¿

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": [
    {
      "id": "order-uuid",
      "orderNumber": "ORD-20260111-0001",
      "items": [...],
      "total": 5940,
      "currency": "JPY",
      "status": "confirmed",
      "paymentMethod": "credit_card",
      "createdAt": "2026-01-11T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 5,
    "totalPages": 1
  }
}
```

---

#### GET /api/v1/orders/:id ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *æ³¨æ–‡æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: æ³¨æ–‡è©³ç´°å–å¾—

**èªè¨¼**: å¿…è¦

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `id`: æ³¨æ–‡ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "id": "order-uuid",
    "orderNumber": "ORD-20260111-0001",
    "items": [
      {
        "productId": "product-uuid",
        "sku": "SKU-001",
        "name": { "ja": "...", "en": "...", "ko": "..." },
        "quantity": 2,
        "unitPrice": 1980,
        "totalPrice": 3960
      }
    ],
    "shippingAddress": {...},
    "subtotal": 3960,
    "shippingFee": 500,
    "tax": 396,
    "total": 4856,
    "currency": "JPY",
    "status": "confirmed",
    "paymentMethod": "credit_card",
    "trackingNumber": null,
    "locale": "ja",
    "createdAt": "2026-01-11T10:00:00Z",
    "updatedAt": "2026-01-11T10:00:00Z"
  }
}
```

**ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:

- `ORDER_NOT_FOUND`: æ³¨æ–‡ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- `FORBIDDEN`: ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãªã—

---

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ API

#### GET /api/v1/users/me ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *èªè¨¼æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—

**èªè¨¼**: å¿…è¦

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "id": "user-uuid",
    "email": "user@example.com",
    "name": "å±±ç”° å¤ªéƒ",
    "locale": "ja",
    "addresses": [
      {
        "id": "address-uuid",
        "name": "è‡ªå®…",
        "postalCode": "100-0001",
        "country": "JP",
        "prefecture": "æ±äº¬éƒ½",
        "city": "åƒä»£ç”°åŒº",
        "address1": "åƒä»£ç”°1-1-1",
        "address2": null,
        "phone": "03-1234-5678",
        "isDefault": true
      }
    ],
    "createdAt": "2026-01-01T00:00:00Z",
    "updatedAt": "2026-01-01T00:00:00Z"
  }
}
```

---

#### PUT /api/v1/users/me ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ãƒã‚¤ãƒšãƒ¼ã‚¸æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–°

**èªè¨¼**: å¿…è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "name": "å±±ç”° èŠ±å­",
  "locale": "en"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: æ›´æ–°å¾Œã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±

---

#### POST /api/v1/users/me/addresses ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *é…é€æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: é…é€å…ˆä½æ‰€è¿½åŠ 

**èªè¨¼**: å¿…è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "name": "ä¼šç¤¾",
  "postalCode": "100-0002",
  "country": "JP",
  "prefecture": "æ±äº¬éƒ½",
  "city": "åƒä»£ç”°åŒº",
  "address1": "éœãŒé–¢1-1-1",
  "phone": "03-9999-9999",
  "isDefault": false
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: æ›´æ–°å¾Œã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼ˆaddresseså«ã‚€ï¼‰

---

#### PUT /api/v1/users/me/addresses/:id ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *é…é€æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: é…é€å…ˆä½æ‰€æ›´æ–°

**èªè¨¼**: å¿…è¦

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `id`: ä½æ‰€ID

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: POST ã¨åŒå½¢å¼

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: æ›´æ–°å¾Œã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±

---

#### DELETE /api/v1/users/me/addresses/:id ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *é…é€æ©Ÿèƒ½ã‚ˆã‚Š*

**èª¬æ˜**: é…é€å…ˆä½æ‰€å‰Šé™¤

**èªè¨¼**: å¿…è¦

**ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `id`: ä½æ‰€ID

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**: æ›´æ–°å¾Œã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±

---

### é…é€ API

#### GET /api/v1/shipping/options ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *å…¨ä¸–ç•Œé…é€ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬*

**èª¬æ˜**: é…é€ã‚ªãƒ—ã‚·ãƒ§ãƒ³å–å¾—

**èªè¨¼**: ä¸è¦

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:

- `country`: é…é€å…ˆå›½ã‚³ãƒ¼ãƒ‰ï¼ˆå¿…é ˆï¼‰
- `postalCode` (optional): éƒµä¾¿ç•ªå·

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": [
    {
      "id": "standard",
      "name": { "ja": "é€šå¸¸é…é€", "en": "Standard Shipping", "ko": "ì¼ë°˜ ë°°ì†¡" },
      "description": { "ja": "5-7å–¶æ¥­æ—¥", "en": "5-7 business days", "ko": "5-7 ì˜ì—…ì¼" },
      "price": 500,
      "estimatedDays": "5-7"
    },
    {
      "id": "express",
      "name": { "ja": "é€Ÿé”é…é€", "en": "Express Shipping", "ko": "ë¹ ë¥¸ ë°°ì†¡" },
      "description": { "ja": "1-3å–¶æ¥­æ—¥", "en": "1-3 business days", "ko": "1-3 ì˜ì—…ì¼" },
      "price": 1500,
      "estimatedDays": "1-3"
    }
  ]
}
```

---

#### POST /api/v1/shipping/calculate ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *å…¨ä¸–ç•Œé…é€ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬*

**èª¬æ˜**: é…é€æ–™è¨ˆç®—

**èªè¨¼**: ä¸è¦

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "country": "JP",
  "postalCode": "100-0001",
  "items": [
    { "productId": "product-uuid", "quantity": 2 }
  ]
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸï¼‰**:

```json
{
  "success": true,
  "data": {
    "options": [...],
    "defaultOptionId": "standard"
  }
}
```

---

## ãƒ¬ãƒ¼ãƒˆåˆ¶é™ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ä¸€èˆ¬çš„ãªAPIè¨­è¨ˆã‹ã‚‰æ¨æ¸¬*

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | åˆ¶é™ |
|---------------|------|
| èªè¨¼ç³» | 10ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| å•†å“ç³» | 100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| ã‚«ãƒ¼ãƒˆç³» | 60ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| æ³¨æ–‡ç³» | 30ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |

ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¶…éæ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:

```json
{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’è¶…éã—ã¾ã—ãŸ",
    "details": {
      "retryAfter": 60
    }
  }
}
```

---

## ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ä¸€èˆ¬çš„ãªAPIè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³*

APIãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯URLãƒ‘ã‚¹ã«å«ã‚ã‚‹ï¼ˆ`/api/v1/`ï¼‰ã€‚

---

## CORSè¨­å®š ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆã‚ˆã‚Š*

è¨±å¯ã•ã‚ŒãŸã‚ªãƒªã‚¸ãƒ³: CloudFront ãƒ‰ãƒ¡ã‚¤ãƒ³

---

## é–¢é€£æ–‡æ›¸

- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: [architecture.md](architecture.md)
- **å‹å®šç¾©**: [interfaces.ts](interfaces.ts)
- **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**: [dataflow.md](dataflow.md)
- **DBã‚¹ã‚­ãƒ¼ãƒ**: [database-schema.md](database-schema.md)

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- ğŸ”µ é’ä¿¡å·: 32ä»¶ (89%)
- ğŸŸ¡ é»„ä¿¡å·: 4ä»¶ (11%)
- ğŸ”´ èµ¤ä¿¡å·: 0ä»¶ (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ª
