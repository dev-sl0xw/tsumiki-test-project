# TDD ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®šç¾©æ›¸: VPC Stack çµ±åˆ

**ã‚¿ã‚¹ã‚¯ID**: TASK-0004
**æ©Ÿèƒ½å**: VPC Stack çµ±åˆ
**è¦ä»¶å**: aws-cdk-serverless-architecture
**ä½œæˆæ—¥**: 2026-01-17
**å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å**: `docs/implements/aws-cdk-serverless-architecture/TASK-0004/vpc-stack-testcases.md`

---

## 1. æ­£å¸¸ç³»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆåŸºæœ¬çš„ãªå‹•ä½œï¼‰

### TC-VS-01: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

- **ãƒ†ã‚¹ãƒˆå**: CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack ãŒç”Ÿæˆã™ã‚‹ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒæ„å›³ã—ãŸæ§‹æˆã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: Template.fromStack(stack).toJSON() ãŒã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ä¸€è‡´ã™ã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: é–‹ç™ºç’°å¢ƒã®æ¨™æº–è¨­å®šï¼ˆvpcCidr: '10.0.0.0/16'ï¼‰
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€è‡´
  - **æœŸå¾…çµæœã®ç†ç”±**: CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«åŸºã¥ããƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: æ„å›³ã—ãªã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ›´ã®æ¤œå‡º
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: VPCã€Subnetã€Gatewayã€Endpoint ç­‰ã®å…¨ãƒªã‚½ãƒ¼ã‚¹æ§‹æˆ
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãŠã‚ˆã³ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä¸€è²«æ€§ã‚’ä¿è¨¼ã™ã‚‹
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ã® CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨æ¯”è¼ƒ
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ä¸€è‡´ã™ã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š

test('snapshot', () => {
  // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: devConfig ã‚’ä½¿ç”¨ã—ã¦ VpcStack ã‚’ä½œæˆ
  // ã€åˆæœŸæ¡ä»¶è¨­å®šã€‘: é–‹ç™ºç’°å¢ƒã®æ¨™æº–è¨­å®šã§ã‚¹ã‚¿ãƒƒã‚¯ã‚’ç”Ÿæˆ
  const app = new cdk.App();
  const stack = new VpcStack(app, 'TestVpcStack', {
    config: devConfig,
  });

  // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: Template.fromStack ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å–å¾—
  const template = Template.fromStack(stack);

  // ã€çµæœæ¤œè¨¼ã€‘: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã®ä¸€è‡´ã‚’ç¢ºèª
  // ã€æ¤œè¨¼é …ç›®ã€‘: CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå…¨ä½“
  // ğŸ”µ ä¿¡é ¼æ€§: CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š
  expect(template.toJSON()).toMatchSnapshot();
});
```

---

### TC-VS-02: VPC ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: VPC ãŒ 1ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack ãŒ VPC ãƒªã‚½ãƒ¼ã‚¹ã‚’æ­£ã—ãä½œæˆã™ã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: AWS::EC2::VPC ãƒªã‚½ãƒ¼ã‚¹ãŒ 1ã¤ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: æ¨™æº–è¨­å®šã§ã® VPC ä½œæˆ
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: VPC ãƒªã‚½ãƒ¼ã‚¹æ•°ãŒ 1
  - **æœŸå¾…çµæœã®ç†ç”±**: è¦ä»¶å®šç¾©æ›¸ REQ-001 ã§æŒ‡å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: VPC åŸºç›¤ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: AWS::EC2::VPC ãƒªã‚½ãƒ¼ã‚¹ã®æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - è¦ä»¶å®šç¾©æ›¸ REQ-001 ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: VPC ãƒªã‚½ãƒ¼ã‚¹ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ AWS::EC2::VPC ãƒªã‚½ãƒ¼ã‚¹ã‚’ 1 ã¤ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: VPC ãƒªã‚½ãƒ¼ã‚¹ãŒ 1 ã¤å­˜åœ¨ã™ã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: REQ-001 ã‚ˆã‚Š

test('VPC ãŒ 1 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: VPC ãƒªã‚½ãƒ¼ã‚¹æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-001 ã‚ˆã‚Š
  template.resourceCountIs('AWS::EC2::VPC', 1);
});
```

---

### TC-VS-03: Subnet ã®ç·æ•°ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: Subnet ãŒ 6ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: 3å±¤æ§‹æˆ x 2 AZ = 6 Subnet ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: AWS::EC2::Subnet ãƒªã‚½ãƒ¼ã‚¹ãŒ 6ã¤ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: Multi-AZ æ§‹æˆã§ã® Subnet ä½œæˆ
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: Subnet ãƒªã‚½ãƒ¼ã‚¹æ•°ãŒ 6ï¼ˆPublic x2, PrivateApp x2, PrivateDb x2ï¼‰
  - **æœŸå¾…çµæœã®ç†ç”±**: è¦ä»¶å®šç¾©æ›¸ REQ-002ã€œ005 ã§æŒ‡å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: 3å±¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆã®ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: AWS::EC2::Subnet ãƒªã‚½ãƒ¼ã‚¹ã®æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - è¦ä»¶å®šç¾©æ›¸ REQ-002ã€œ005 ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: 3å±¤ã‚µãƒ–ãƒãƒƒãƒˆæ§‹æˆãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ 6 ã¤ã® Subnet ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: 6 ã¤ã® Subnet ãŒå­˜åœ¨ã™ã‚‹ï¼ˆ3å±¤ x 2 AZï¼‰
// ğŸ”µ ä¿¡é ¼æ€§: REQ-002ã€œ005 ã‚ˆã‚Š

test('Subnet ãŒ 6 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ï¼ˆ3å±¤ x 2 AZï¼‰', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: Subnet ãƒªã‚½ãƒ¼ã‚¹ç·æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-002ã€œ005 ã‚ˆã‚Š
  template.resourceCountIs('AWS::EC2::Subnet', 6);
});
```

---

### TC-VS-04: Internet Gateway ã®å­˜åœ¨ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: Internet Gateway ãŒ 1ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack ãŒ IGW ã‚’æ­£ã—ãä½œæˆã™ã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: AWS::EC2::InternetGateway ãƒªã‚½ãƒ¼ã‚¹ãŒ 1ã¤ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: Public Subnet ç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶š
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: IGW ãƒªã‚½ãƒ¼ã‚¹æ•°ãŒ 1
  - **æœŸå¾…çµæœã®ç†ç”±**: è¦ä»¶å®šç¾©æ›¸ REQ-006 ã§æŒ‡å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šåŸºç›¤ã®ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: AWS::EC2::InternetGateway ãƒªã‚½ãƒ¼ã‚¹ã®æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - è¦ä»¶å®šç¾©æ›¸ REQ-006 ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: Internet Gateway ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ IGW ã‚’ 1 ã¤ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: IGW ãƒªã‚½ãƒ¼ã‚¹ãŒ 1 ã¤å­˜åœ¨ã™ã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: REQ-006 ã‚ˆã‚Š

test('Internet Gateway ãŒ 1 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: IGW ãƒªã‚½ãƒ¼ã‚¹æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-006 ã‚ˆã‚Š
  template.resourceCountIs('AWS::EC2::InternetGateway', 1);
});
```

---

### TC-VS-05: NAT Gateway ã® Multi-AZ é…ç½®ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: NAT Gateway ãŒ 2ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: å„ AZ ã« NAT Gateway ãŒé…ç½®ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: AWS::EC2::NatGateway ãƒªã‚½ãƒ¼ã‚¹ãŒ 2ã¤ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: Multi-AZ æ§‹æˆã§ã®é«˜å¯ç”¨æ€§ NAT
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: NAT Gateway ãƒªã‚½ãƒ¼ã‚¹æ•°ãŒ 2
  - **æœŸå¾…çµæœã®ç†ç”±**: è¦ä»¶å®šç¾©æ›¸ REQ-007ã€NFR-003 ã§æŒ‡å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Private Subnet ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã¨é«˜å¯ç”¨æ€§ã®ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: AWS::EC2::NatGateway ãƒªã‚½ãƒ¼ã‚¹ã®æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - è¦ä»¶å®šç¾©æ›¸ REQ-007 ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: NAT Gateway ãŒ Multi-AZ ã§é…ç½®ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ NAT Gateway ã‚’ 2 ã¤ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: NAT Gateway ãƒªã‚½ãƒ¼ã‚¹ãŒ 2 ã¤å­˜åœ¨ã™ã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: REQ-007 ã‚ˆã‚Š

test('NAT Gateway ãŒ 2 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: NAT Gateway ãƒªã‚½ãƒ¼ã‚¹æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-007 ã‚ˆã‚Š
  template.resourceCountIs('AWS::EC2::NatGateway', 2);
});
```

---

### TC-VS-06: VPC Endpoint ã®ç·æ•°ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: VPC Endpoint ãŒ 7ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: å…¨ã¦ã®å¿…è¦ãª VPC Endpoint ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: AWS::EC2::VPCEndpoint ãƒªã‚½ãƒ¼ã‚¹ãŒ 7ã¤ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: SSMã€ECRã€CloudWatch Logsã€S3 ç”¨ã® Endpoint
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: VPC Endpoint ãƒªã‚½ãƒ¼ã‚¹æ•°ãŒ 7ï¼ˆInterface x6 + Gateway x1ï¼‰
  - **æœŸå¾…çµæœã®ç†ç”±**: è¦ä»¶å®šç¾©æ›¸ REQ-008ã€œ011 ã§æŒ‡å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: AWS ã‚µãƒ¼ãƒ“ã‚¹ã¸ã® VPC å†…éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã®ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: AWS::EC2::VPCEndpoint ãƒªã‚½ãƒ¼ã‚¹ã®æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - è¦ä»¶å®šç¾©æ›¸ REQ-008ã€œ011 ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å…¨ VPC Endpoint ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ 7 ã¤ã® VPC Endpoint ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: VPC Endpoint ãƒªã‚½ãƒ¼ã‚¹ãŒ 7 ã¤å­˜åœ¨ã™ã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: REQ-008ã€œ011 ã‚ˆã‚Š

test('VPC Endpoint ãŒ 7 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨ï¼ˆSSM x3, ECR x2, Logs x1, S3 x1ï¼‰', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: VPC Endpoint ãƒªã‚½ãƒ¼ã‚¹ç·æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-008ã€œ011 ã‚ˆã‚Š
  template.resourceCountIs('AWS::EC2::VPCEndpoint', 7);
});
```

---

### TC-VS-07: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack.vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ IVpc å‹ã§å…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: stack.vpc ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: ä»– Stack ã‹ã‚‰å‚ç…§ã™ã‚‹ãŸã‚ã® VPC
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå®šç¾©ã•ã‚Œã¦ãŠã‚Šã€IVpc å‹
  - **æœŸå¾…çµæœã®ç†ç”±**: CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Stack é–“å‚ç…§ã®æ­£å¸¸æ€§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å­˜åœ¨ã¨å‹
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack.vpc ãŒ IVpc å‹ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
// ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

test('vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å­˜åœ¨
  // ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š
  expect(stack.vpc).toBeDefined();
});
```

---

### TC-VS-08: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¦ç´ æ•° 2 ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack.publicSubnets ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: stack.publicSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: ALB é…ç½®ç”¨ã® Public Subnet
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—
  - **æœŸå¾…çµæœã®ç†ç”±**: 2 AZ æ§‹æˆã§å„ AZ ã« 1 ã¤ãšã¤
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Public Subnet ã® Stack é–“å‚ç…§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack.publicSubnets ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: publicSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
// ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

test('publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š
  expect(stack.publicSubnets).toHaveLength(2);
});
```

---

### TC-VS-09: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¦ç´ æ•° 2 ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack.privateAppSubnets ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: stack.privateAppSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: ECS ã‚¿ã‚¹ã‚¯é…ç½®ç”¨ã® Private App Subnet
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—
  - **æœŸå¾…çµæœã®ç†ç”±**: 2 AZ æ§‹æˆã§å„ AZ ã« 1 ã¤ãšã¤
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Private App Subnet ã® Stack é–“å‚ç…§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack.privateAppSubnets ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: privateAppSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
// ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

test('privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š
  expect(stack.privateAppSubnets).toHaveLength(2);
});
```

---

### TC-VS-10: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¦ç´ æ•° 2 ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack.privateDbSubnets ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: stack.privateDbSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: Aurora é…ç½®ç”¨ã® Private DB Subnet
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—
  - **æœŸå¾…çµæœã®ç†ç”±**: 2 AZ æ§‹æˆã§å„ AZ ã« 1 ã¤ãšã¤
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Private DB Subnet ã® Stack é–“å‚ç…§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæ­£ã—ãå…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack.privateDbSubnets ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: privateDbSubnets ãŒ 2 è¦ç´ ã®é…åˆ—
// ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

test('privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ 2 è¦ç´ ã®é…åˆ—ã§ã‚ã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¦ç´ æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š
  expect(stack.privateDbSubnets).toHaveLength(2);
});
```

---

### TC-VS-11: VpcConstruct çµ±åˆç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: VpcConstruct ãŒæ­£ã—ãçµ±åˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack å†…ã§ VpcConstruct ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: VPC ã® CIDR Block ãŒ config.vpcCidr ã¨ä¸€è‡´
- **å…¥åŠ›å€¤**: devConfigï¼ˆvpcCidr: '10.0.0.0/16'ï¼‰ã‚’ä½¿ç”¨ã—ãŸ VpcStack
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: ç’°å¢ƒè¨­å®šã‹ã‚‰ CIDR ã‚’å–å¾—
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: VPC ã® CidrBlock ãŒ '10.0.0.0/16'
  - **æœŸå¾…çµæœã®ç†ç”±**: config.vpcCidr ã®å€¤ãŒ VpcConstruct ã«æ¸¡ã•ã‚Œã‚‹
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Construct çµ±åˆã®æ­£å¸¸æ€§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: VPC ãƒªã‚½ãƒ¼ã‚¹ã® CidrBlock ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»è¦ä»¶å®šç¾©æ›¸ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: VpcConstruct ãŒæ­£ã—ãçµ±åˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ config.vpcCidr ã‚’ä½¿ç”¨ã—ã¦ VpcConstruct ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: VPC ã® CIDR Block ãŒ config.vpcCidr ã¨ä¸€è‡´
// ğŸ”µ ä¿¡é ¼æ€§: ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã‚ˆã‚Š

test('VPC ã® CIDR Block ãŒ config.vpcCidr ã¨ä¸€è‡´ã™ã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: VPC ãƒªã‚½ãƒ¼ã‚¹ã® CidrBlock
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-001 ã‚ˆã‚Š
  template.hasResourceProperties('AWS::EC2::VPC', {
    CidrBlock: '10.0.0.0/16',
  });
});
```

---

### TC-VS-12: EndpointsConstruct çµ±åˆç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: EndpointsConstruct ãŒæ­£ã—ãçµ±åˆã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹**: VpcStack å†…ã§ EndpointsConstruct ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  - **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: å…¨ã¦ã® VPC Endpoint ãŒ Interface/Gateway ã‚¿ã‚¤ãƒ—ã§ä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig ã‚’ä½¿ç”¨ã—ãŸ VpcStack ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  - **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§å…¨ Endpoint ã‚’æœ‰åŠ¹åŒ–
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: Interface Endpoint ãŒ 6ã¤ã€Gateway Endpoint ãŒ 1ã¤
  - **æœŸå¾…çµæœã®ç†ç”±**: EndpointsConstruct ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: Endpoint Construct çµ±åˆã®æ­£å¸¸æ€§ã‚’ç¢ºèª
  - **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: VPC Endpoint ãƒªã‚½ãƒ¼ã‚¹ã®ã‚¿ã‚¤ãƒ—
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ãƒ»è¦ä»¶å®šç¾©æ›¸ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: EndpointsConstruct ãŒæ­£ã—ãçµ±åˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: VpcStack ãŒ EndpointsConstruct ã‚’çµ±åˆã—ã€å…¨ Endpoint ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: Interface x6 + Gateway x1 ã® Endpoint ãŒä½œæˆã•ã‚Œã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: REQ-008ã€œ011 ã‚ˆã‚Š

test('Interface Endpoint ãŒ 6 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: Interface ã‚¿ã‚¤ãƒ—ã® VPC Endpoint æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-008ã€œ010 ã‚ˆã‚Š
  const interfaceEndpoints = template.findResources('AWS::EC2::VPCEndpoint', {
    Properties: {
      VpcEndpointType: 'Interface',
    },
  });
  expect(Object.keys(interfaceEndpoints).length).toBe(6);
});

test('Gateway Endpoint ãŒ 1 ã¤ä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€æ¤œè¨¼é …ç›®ã€‘: Gateway ã‚¿ã‚¤ãƒ—ã® VPC Endpoint æ•°
  // ğŸ”µ ä¿¡é ¼æ€§: REQ-011 ã‚ˆã‚Š
  const gatewayEndpoints = template.findResources('AWS::EC2::VPCEndpoint', {
    Properties: {
      VpcEndpointType: 'Gateway',
    },
  });
  expect(Object.keys(gatewayEndpoints).length).toBe(1);
});
```

---

## 2. ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼‰

### TC-VS-13: config æœªè¨­å®šã§ã® TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼

- **ãƒ†ã‚¹ãƒˆå**: config æœªè¨­å®šæ™‚ã« TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã®ç¢ºèª
  - **ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®æ¦‚è¦**: VpcStackProps.config ã¯å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  - **ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®é‡è¦æ€§**: å¿…é ˆè¨­å®šã®æ¬ è½ã‚’é˜²æ­¢
- **å…¥åŠ›å€¤**: config ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã—ã§ VpcStack ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
  - **ä¸æ­£ãªç†ç”±**: VpcStackProps ã§ config ã¯ required
  - **å®Ÿéš›ã®ç™ºç”Ÿã‚·ãƒŠãƒªã‚ª**: é–‹ç™ºè€…ãŒè¨­å®šã‚’å¿˜ã‚ŒãŸå ´åˆ
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼
  - **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹**: Property 'config' is missing
  - **ã‚·ã‚¹ãƒ†ãƒ ã®å®‰å…¨æ€§**: å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ã‚’é˜²æ­¢
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: å‹å®‰å…¨æ€§ã®ç¢ºèª
  - **å“è³ªä¿è¨¼ã®è¦³ç‚¹**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å•é¡Œã‚’æ¤œå‡º
- ğŸŸ¡ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é»„ä¿¡å· - TypeScript ã®å‹•ä½œä»•æ§˜ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: config ãŒå¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: TypeScript å‹å®šç¾©ã«ã‚ˆã‚‹å¿…é ˆãƒã‚§ãƒƒã‚¯
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
// ğŸŸ¡ ä¿¡é ¼æ€§: TypeScript å‹•ä½œä»•æ§˜ã‹ã‚‰

// ã“ã®ãƒ†ã‚¹ãƒˆã¯ TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€
// å®Ÿè¡Œæ™‚ãƒ†ã‚¹ãƒˆã§ã¯ãªã„ã€‚å‹å®šç¾©ã§ config: EnvironmentConfig ã‚’
// required ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã§ä¿è¨¼ã•ã‚Œã‚‹ã€‚
```

---

### TC-VS-14: ç„¡åŠ¹ãª CIDR æŒ‡å®šæ™‚ã®ã‚¨ãƒ©ãƒ¼

- **ãƒ†ã‚¹ãƒˆå**: ç„¡åŠ¹ãª CIDR å½¢å¼æŒ‡å®šæ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã®ç¢ºèª
  - **ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®æ¦‚è¦**: ä¸æ­£ãª CIDR å½¢å¼ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆ
  - **ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®é‡è¦æ€§**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šãƒŸã‚¹ã‚’é˜²æ­¢
- **å…¥åŠ›å€¤**: vpcCidr: 'invalid-cidr' ã®ã‚ˆã†ãªä¸æ­£ãªå€¤
  - **ä¸æ­£ãªç†ç”±**: CIDR å½¢å¼ã¨ã—ã¦è§£é‡ˆã§ããªã„
  - **å®Ÿéš›ã®ç™ºç”Ÿã‚·ãƒŠãƒªã‚ª**: parameter.ts ã®è¨­å®šãƒŸã‚¹
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: CDK/CloudFormation ã‚¨ãƒ©ãƒ¼
  - **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹**: Invalid CIDR format
  - **ã‚·ã‚¹ãƒ†ãƒ ã®å®‰å…¨æ€§**: ç„¡åŠ¹ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é˜²æ­¢
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: å…¥åŠ›æ¤œè¨¼ã®ç¢ºèª
  - **å“è³ªä¿è¨¼ã®è¦³ç‚¹**: è¨­å®šãƒŸã‚¹ã®æ—©æœŸæ¤œå‡º
- ğŸŸ¡ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é»„ä¿¡å· - CDK ã®å‹•ä½œä»•æ§˜ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç„¡åŠ¹ãª CIDR å½¢å¼ãŒæ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: ä¸æ­£ãª vpcCidr ã§ VpcStack ã‚’ä½œæˆã—ã€ã‚¨ãƒ©ãƒ¼ã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: CDK ã¾ãŸã¯ CloudFormation ãƒ¬ãƒ™ãƒ«ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
// ğŸŸ¡ ä¿¡é ¼æ€§: CDK å‹•ä½œä»•æ§˜ã‹ã‚‰

test('ç„¡åŠ¹ãª CIDR å½¢å¼ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã“ã¨', () => {
  // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ç„¡åŠ¹ãª CIDR ã‚’å«ã‚€è¨­å®š
  const invalidConfig: EnvironmentConfig = {
    ...devConfig,
    vpcCidr: 'invalid-cidr',
  };

  // ã€å®Ÿè¡Œã¨æ¤œè¨¼ã€‘: VpcStack ä½œæˆæ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
  // ğŸŸ¡ ä¿¡é ¼æ€§: CDK å‹•ä½œä»•æ§˜ã‹ã‚‰
  expect(() => {
    new VpcStack(app, 'InvalidVpcStack', {
      config: invalidConfig,
    });
  }).toThrow();
});
```

---

## 3. å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆæœ€å°å€¤ã€æœ€å¤§å€¤ã€nullç­‰ï¼‰

### TC-VS-15: ç©ºæ–‡å­—ã® vpcCidr ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: vpcCidr ãŒç©ºæ–‡å­—ã®å ´åˆã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã®ç¢ºèª
  - **å¢ƒç•Œå€¤ã®æ„å‘³**: è¨­å®šå€¤ãŒç©ºã®å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‹•ä½œ
  - **å¢ƒç•Œå€¤ã§ã®å‹•ä½œä¿è¨¼**: VpcConstruct ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ '10.0.0.0/16' ãŒé©ç”¨
- **å…¥åŠ›å€¤**: vpcCidr: '' ï¼ˆç©ºæ–‡å­—ï¼‰
  - **å¢ƒç•Œå€¤é¸æŠã®æ ¹æ‹ **: è¨­å®šæ¼ã‚Œã®ã‚·ãƒŠãƒªã‚ª
  - **å®Ÿéš›ã®ä½¿ç”¨å ´é¢**: parameter.ts ã§å€¤ãŒæœªè¨­å®šã®å ´åˆ
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: VpcConstruct ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ CIDR '10.0.0.0/16' ãŒä½¿ç”¨ã•ã‚Œã‚‹
  - **å¢ƒç•Œã§ã®æ­£ç¢ºæ€§**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  - **ä¸€è²«ã—ãŸå‹•ä½œ**: ç©ºæ–‡å­—ã§ã‚‚å®‰å…¨ã«å‹•ä½œ
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
  - **å …ç‰¢æ€§ã®ç¢ºèª**: è¨­å®šæ¼ã‚Œæ™‚ã®å®‰å…¨ãªå‹•ä½œ
- ğŸŸ¡ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é»„ä¿¡å· - VpcConstruct ã®å®Ÿè£…ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç©ºæ–‡å­—ã® vpcCidr ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: vpcCidr ãŒç©ºæ–‡å­—ã®å ´åˆã® VpcStack å‹•ä½œã‚’æ¤œè¨¼
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: VpcConstruct ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ CIDR ãŒä½¿ç”¨ã•ã‚Œã‚‹
// ğŸŸ¡ ä¿¡é ¼æ€§: VpcConstruct å®Ÿè£…ã‹ã‚‰

test('vpcCidr ãŒç©ºæ–‡å­—ã®å ´åˆã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨', () => {
  // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: vpcCidr ã‚’ç©ºæ–‡å­—ã«è¨­å®š
  const emptyConfig: EnvironmentConfig = {
    ...devConfig,
    vpcCidr: '',
  };

  // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: VpcStack ã‚’ä½œæˆ
  const emptyStack = new VpcStack(app, 'EmptyVpcStack', {
    config: emptyConfig,
  });
  const emptyTemplate = Template.fromStack(emptyStack);

  // ã€çµæœæ¤œè¨¼ã€‘: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ CIDR ãŒä½¿ç”¨ã•ã‚Œã‚‹
  // ğŸŸ¡ ä¿¡é ¼æ€§: VpcConstruct å®Ÿè£…ã‹ã‚‰
  emptyTemplate.hasResourceProperties('AWS::EC2::VPC', {
    CidrBlock: '10.0.0.0/16',
  });
});
```

---

### TC-VS-16: ç’°å¢ƒåˆ¥è¨­å®šï¼ˆDev/Prodï¼‰ã§ã®å‹•ä½œç¢ºèª

- **ãƒ†ã‚¹ãƒˆå**: ç•°ãªã‚‹ç’°å¢ƒè¨­å®šã§æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã®ç¢ºèª
  - **å¢ƒç•Œå€¤ã®æ„å‘³**: ç’°å¢ƒã«ã‚ˆã‚‹è¨­å®šã®é•ã„
  - **å¢ƒç•Œå€¤ã§ã®å‹•ä½œä¿è¨¼**: Dev/Prod ä¸¡æ–¹ã§æ­£å¸¸ã« Stack ãŒä½œæˆã•ã‚Œã‚‹
- **å…¥åŠ›å€¤**: devConfig / prodConfig
  - **å¢ƒç•Œå€¤é¸æŠã®æ ¹æ‹ **: å®Ÿéš›ã®ä½¿ç”¨ç’°å¢ƒ
  - **å®Ÿéš›ã®ä½¿ç”¨å ´é¢**: æœ¬ç•ªç’°å¢ƒã¨é–‹ç™ºç’°å¢ƒã®åˆ‡ã‚Šæ›¿ãˆ
- **æœŸå¾…ã•ã‚Œã‚‹çµæœ**: ä¸¡ç’°å¢ƒã§ VPC Stack ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã‚‹
  - **å¢ƒç•Œã§ã®æ­£ç¢ºæ€§**: ç’°å¢ƒåˆ¥è¨­å®šãŒæ­£ã—ãåæ˜ 
  - **ä¸€è²«ã—ãŸå‹•ä½œ**: ä¸¡ç’°å¢ƒã§åŒã˜ãƒªã‚½ãƒ¼ã‚¹æ§‹æˆ
- **ãƒ†ã‚¹ãƒˆã®ç›®çš„**: ç’°å¢ƒåˆ‡ã‚Šæ›¿ãˆã®æ­£å¸¸æ€§ç¢ºèª
  - **å …ç‰¢æ€§ã®ç¢ºèª**: ãƒãƒ«ãƒç’°å¢ƒå¯¾å¿œã®ç¢ºèª
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - parameter.ts ã®å®Ÿè£…ã‚ˆã‚Š

```typescript
// ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç’°å¢ƒåˆ¥è¨­å®šã§æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
// ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: devConfig ã¨ prodConfig ã®ä¸¡æ–¹ã§ VpcStack ã‚’ä½œæˆ
// ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ä¸¡ç’°å¢ƒã§æ­£å¸¸ã«ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹
// ğŸ”µ ä¿¡é ¼æ€§: parameter.ts ã‚ˆã‚Š

describe('ç’°å¢ƒåˆ¥è¨­å®šã§ã®å‹•ä½œç¢ºèª', () => {
  test('devConfig ã§æ­£å¸¸ã« Stack ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
    // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: devConfig ã‚’ä½¿ç”¨
    const devStack = new VpcStack(app, 'DevVpcStack', {
      config: devConfig,
    });
    const devTemplate = Template.fromStack(devStack);

    // ã€æ¤œè¨¼é …ç›®ã€‘: åŸºæœ¬ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨
    // ğŸ”µ ä¿¡é ¼æ€§: parameter.ts ã‚ˆã‚Š
    devTemplate.resourceCountIs('AWS::EC2::VPC', 1);
  });

  test('prodConfig ã§æ­£å¸¸ã« Stack ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {
    // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: prodConfig ã‚’ä½¿ç”¨
    const prodStack = new VpcStack(app, 'ProdVpcStack', {
      config: prodConfig,
    });
    const prodTemplate = Template.fromStack(prodStack);

    // ã€æ¤œè¨¼é …ç›®ã€‘: åŸºæœ¬ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨
    // ğŸ”µ ä¿¡é ¼æ€§: parameter.ts ã‚ˆã‚Š
    prodTemplate.resourceCountIs('AWS::EC2::VPC', 1);
  });
});
```

---

## 4. é–‹ç™ºè¨€èªãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

- **ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª**: TypeScript ~5.6.3
  - **è¨€èªé¸æŠã®ç†ç”±**: AWS CDK v2 ã®æ¨å¥¨è¨€èªã€å‹å®‰å…¨æ€§ã®ç¢ºä¿
  - **ãƒ†ã‚¹ãƒˆã«é©ã—ãŸæ©Ÿèƒ½**: å‹å®šç¾©ã«ã‚ˆã‚‹é™çš„è§£æã€async/await ã‚µãƒãƒ¼ãƒˆ
- **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Jest ^29.7.0
  - **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é¸æŠã®ç†ç”±**: CDK æ¨™æº–ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆå¯¾å¿œ
  - **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒ**: Node.js ES2018 Target
- ğŸ”µ **ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: é’ä¿¡å· - package.jsonã€tsconfig.json ã‚ˆã‚Šç¢ºèªæ¸ˆã¿

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
infra/
â””â”€â”€ test/
    â””â”€â”€ vpc-stack.test.ts    # VpcStack ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# ç‰¹å®šãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ
npm test -- vpc-stack.test.ts

# Watch ãƒ¢ãƒ¼ãƒ‰
npm test -- --watch

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ã
npm test -- --coverage

# ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ›´æ–°
npm test -- -u
```

---

## 5. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…æ™‚ã®æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆæŒ‡é‡

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆ

```typescript
/**
 * VPC Stack ãƒ†ã‚¹ãƒˆ
 *
 * TASK-0004: VPC Stack çµ±åˆ
 * ãƒ•ã‚§ãƒ¼ã‚º: TDD Red Phase - å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®ä½œæˆ
 *
 * ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹:
 * - TC-VS-01: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
 * - TC-VS-02: VPC ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨ç¢ºèª
 * - TC-VS-03: Subnet ã®ç·æ•°ç¢ºèª
 * - TC-VS-04: Internet Gateway ã®å­˜åœ¨ç¢ºèª
 * - TC-VS-05: NAT Gateway ã® Multi-AZ é…ç½®ç¢ºèª
 * - TC-VS-06: VPC Endpoint ã®ç·æ•°ç¢ºèª
 * - TC-VS-07ã€œ10: Stack å‡ºåŠ›ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¢ºèª
 * - TC-VS-11ã€œ12: Construct çµ±åˆç¢ºèª
 * - TC-VS-13ã€œ14: ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆ
 * - TC-VS-15ã€œ16: å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ
 *
 * ğŸ”µ ä¿¡é ¼æ€§: è¦ä»¶å®šç¾©æ›¸ REQ-001ã€œ011ã€ã‚¿ã‚¹ã‚¯å®šç¾©æ›¸ã«åŸºã¥ããƒ†ã‚¹ãƒˆ
 */
```

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ¡ãƒ³ãƒˆ

```typescript
beforeEach(() => {
  // ã€ãƒ†ã‚¹ãƒˆå‰æº–å‚™ã€‘: CDK App ã¨ VpcStack ã‚’ä½œæˆ
  // ã€ç’°å¢ƒåˆæœŸåŒ–ã€‘: å‰ã®ãƒ†ã‚¹ãƒˆã®çŠ¶æ…‹ãŒå½±éŸ¿ã—ãªã„ã‚ˆã†ã€æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ç”¨
  app = new cdk.App();
  stack = new VpcStack(app, 'TestVpcStack', {
    config: devConfig,
  });
  // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: Template.fromStack(stack) ã§ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ
  // ã€å‡¦ç†å†…å®¹ã€‘: VpcStack ãŒä½œæˆã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå½¢å¼ã§å–å¾—
  template = Template.fromStack(stack);
});

afterEach(() => {
  // ã€ãƒ†ã‚¹ãƒˆå¾Œå‡¦ç†ã€‘: æ˜ç¤ºçš„ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã¯ä¸è¦
  // ã€çŠ¶æ…‹å¾©å…ƒã€‘: Jest ãŒè‡ªå‹•çš„ã«ãƒ†ã‚¹ãƒˆé–“ã®åˆ†é›¢ã‚’ä¿è¨¼
});
```

---

## 6. è¦ä»¶å®šç¾©ã¨ã®å¯¾å¿œé–¢ä¿‚

### å‚ç…§ã—ãŸæ©Ÿèƒ½æ¦‚è¦

- **è¨­è¨ˆæ–‡æ›¸**: `docs/design/aws-cdk-serverless-architecture/architecture.md` - CDK Stack æ§‹æˆã‚»ã‚¯ã‚·ãƒ§ãƒ³
- **ã‚¿ã‚¹ã‚¯å®šç¾©**: `docs/tasks/aws-cdk-serverless-architecture/TASK-0004.md` - VPC Stack å®šç¾©

### å‚ç…§ã—ãŸå…¥åŠ›ãƒ»å‡ºåŠ›ä»•æ§˜

- **è¦ä»¶å®šç¾©æ›¸**: `docs/implements/aws-cdk-serverless-architecture/TASK-0004/vpc-stack-requirements.md` - 2.1 å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€2.2 å‡ºåŠ›å€¤
- **TDDé–‹ç™ºãƒãƒ¼ãƒˆ**: `docs/implements/aws-cdk-serverless-architecture/TASK-0004/note.md` - 3. é–¢é€£å®Ÿè£…

### å‚ç…§ã—ãŸåˆ¶ç´„æ¡ä»¶

- **è¦ä»¶å®šç¾©æ›¸ REQ-001ã€œ011**: VPCã€Subnetã€Gatewayã€Endpoint ã®ä»•æ§˜
- **è¦ä»¶å®šç¾©æ›¸ NFR-001ã€œ003**: é«˜å¯ç”¨æ€§ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æœ€é©åŒ–
- **è¦ä»¶å®šç¾©æ›¸ REQ-401, REQ-403, REQ-405**: æŠ€è¡“åˆ¶ç´„

### å‚ç…§ã—ãŸä½¿ç”¨ä¾‹

- **TDDé–‹ç™ºãƒãƒ¼ãƒˆ**: `docs/implements/aws-cdk-serverless-architecture/TASK-0004/note.md` - 4. è¨­è¨ˆæ–‡æ›¸ - VpcStack å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

---

## 7. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚µãƒãƒªãƒ¼

| ãƒ†ã‚¹ãƒˆID | åˆ†é¡ | ãƒ†ã‚¹ãƒˆå†…å®¹ | ä¿¡é ¼æ€§ |
|---------|------|-----------|--------|
| TC-VS-01 | æ­£å¸¸ç³» | ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ | ğŸ”µ |
| TC-VS-02 | æ­£å¸¸ç³» | VPC ãƒªã‚½ãƒ¼ã‚¹ã®å­˜åœ¨ç¢ºèª | ğŸ”µ |
| TC-VS-03 | æ­£å¸¸ç³» | Subnet ã®ç·æ•°ç¢ºèª | ğŸ”µ |
| TC-VS-04 | æ­£å¸¸ç³» | Internet Gateway ã®å­˜åœ¨ç¢ºèª | ğŸ”µ |
| TC-VS-05 | æ­£å¸¸ç³» | NAT Gateway ã® Multi-AZ é…ç½®ç¢ºèª | ğŸ”µ |
| TC-VS-06 | æ­£å¸¸ç³» | VPC Endpoint ã®ç·æ•°ç¢ºèª | ğŸ”µ |
| TC-VS-07 | æ­£å¸¸ç³» | vpc ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª | ğŸ”µ |
| TC-VS-08 | æ­£å¸¸ç³» | publicSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª | ğŸ”µ |
| TC-VS-09 | æ­£å¸¸ç³» | privateAppSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª | ğŸ”µ |
| TC-VS-10 | æ­£å¸¸ç³» | privateDbSubnets ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å…¬é–‹ç¢ºèª | ğŸ”µ |
| TC-VS-11 | æ­£å¸¸ç³» | VpcConstruct çµ±åˆç¢ºèª | ğŸ”µ |
| TC-VS-12 | æ­£å¸¸ç³» | EndpointsConstruct çµ±åˆç¢ºèª | ğŸ”µ |
| TC-VS-13 | ç•°å¸¸ç³» | config æœªè¨­å®šã§ã® TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ | ğŸŸ¡ |
| TC-VS-14 | ç•°å¸¸ç³» | ç„¡åŠ¹ãª CIDR æŒ‡å®šæ™‚ã®ã‚¨ãƒ©ãƒ¼ | ğŸŸ¡ |
| TC-VS-15 | å¢ƒç•Œå€¤ | ç©ºæ–‡å­—ã® vpcCidr ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä½¿ç”¨ | ğŸŸ¡ |
| TC-VS-16 | å¢ƒç•Œå€¤ | ç’°å¢ƒåˆ¥è¨­å®šã§ã®å‹•ä½œç¢ºèª | ğŸ”µ |

---

## 8. ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

| ãƒ¬ãƒ™ãƒ« | ä»¶æ•° | å‰²åˆ |
|--------|------|------|
| ğŸ”µ é’ä¿¡å· | 13 | 81% |
| ğŸŸ¡ é»„ä¿¡å· | 3 | 19% |
| ğŸ”´ èµ¤ä¿¡å· | 0 | 0% |

**å“è³ªè©•ä¾¡**: âœ… é«˜å“è³ª - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®81%ãŒè¦ä»¶å®šç¾©æ›¸ãƒ»è¨­è¨ˆæ–‡æ›¸ã«ã‚ˆã‚Šç¢ºèªæ¸ˆã¿

### é»„ä¿¡å·é …ç›®ä¸€è¦§

| ãƒ†ã‚¹ãƒˆID | é …ç›® | ç†ç”± |
|---------|------|------|
| TC-VS-13 | config æœªè¨­å®šã‚¨ãƒ©ãƒ¼ | TypeScript å‹•ä½œä»•æ§˜ã‹ã‚‰ã®æ¨æ¸¬ |
| TC-VS-14 | ç„¡åŠ¹ãª CIDR ã‚¨ãƒ©ãƒ¼ | CDK å‹•ä½œä»•æ§˜ã‹ã‚‰ã®æ¨æ¸¬ |
| TC-VS-15 | ç©ºæ–‡å­— vpcCidr | VpcConstruct å®Ÿè£…ã‹ã‚‰ã®æ¨æ¸¬ |

---

## 9. é–¢é€£æ–‡æ›¸

| æ–‡æ›¸ | ãƒ‘ã‚¹ |
|------|------|
| ã‚¿ã‚¹ã‚¯å®šç¾© | `docs/tasks/aws-cdk-serverless-architecture/TASK-0004.md` |
| TDDé–‹ç™ºãƒãƒ¼ãƒˆ | `docs/implements/aws-cdk-serverless-architecture/TASK-0004/note.md` |
| è¦ä»¶å®šç¾©æ›¸ | `docs/implements/aws-cdk-serverless-architecture/TASK-0004/vpc-stack-requirements.md` |
| è¦ä»¶å®šç¾©æ›¸ï¼ˆå…¨ä½“ï¼‰ | `docs/spec/aws-cdk-serverless-architecture/requirements.md` |
| ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ | `docs/design/aws-cdk-serverless-architecture/architecture.md` |
| VpcConstruct ãƒ†ã‚¹ãƒˆ | `infra/test/construct/vpc/vpc-construct.test.ts` |
| EndpointsConstruct ãƒ†ã‚¹ãƒˆ | `infra/test/construct/vpc/endpoints-construct.test.ts` |
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š | `infra/parameter.ts` |
