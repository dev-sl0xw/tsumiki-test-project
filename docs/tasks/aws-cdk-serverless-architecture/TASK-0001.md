# TASK-0001: CDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–

**ã‚¿ã‚¹ã‚¯ID**: TASK-0001
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: DIRECT
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 1 - åŸºç›¤æ§‹ç¯‰
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸ”µ *è¦ä»¶å®šç¾©æ›¸ãƒ»è¨­è¨ˆæ–‡æ›¸ã‚ˆã‚Š*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [ğŸ“‹ overview.md](overview.md)
- **è¦ä»¶å®šç¾©**: [ğŸ“‹ requirements.md](../../spec/aws-cdk-serverless-architecture/requirements.md) - REQ-401, REQ-402, REQ-403
- **è¨­è¨ˆæ–‡æ›¸**: [ğŸ“ architecture.md](../../design/aws-cdk-serverless-architecture/architecture.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

AWS CDK v2 (TypeScript) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–ã‚’è¡Œã†ã€‚cdk init ã«ã‚ˆã‚‹é››å½¢ç”Ÿæˆã€å¿…è¦ãªä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ç’°å¢ƒåˆ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ parameter.ts ã®ä½œæˆã€TypeScript è¨­å®šã‚’å«ã‚€ã€‚ã“ã®ã‚¿ã‚¹ã‚¯ã¯ Phase 1 ã®æœ€åˆã®ã‚¿ã‚¹ã‚¯ã§ã‚ã‚Šã€å¾Œç¶šã®ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã®å‰æã¨ãªã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: ãªã—ï¼ˆPhase 1 é–‹å§‹ã‚¿ã‚¹ã‚¯ï¼‰
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: [TASK-0002](TASK-0002.md) (VPC Construct å®Ÿè£…)

## å®Œäº†æ¡ä»¶

- [x] `cdk init app --language typescript` ã«ã‚ˆã‚Šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé››å½¢ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [x] å¿…è¦ãª npm ä¾å­˜é–¢ä¿‚ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ï¼ˆaws-cdk-lib, constructs ç­‰ï¼‰
- [x] parameter.ts ã« Dev/Prod ç’°å¢ƒè¨­å®šãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [x] tsconfig.json ãŒè¨­è¨ˆæ–‡æ›¸ã«å¾“ã£ã¦è¨­å®šã•ã‚Œã¦ã„ã‚‹
- [x] `npm run build` ãŒæ­£å¸¸ã«å®Œäº†ã™ã‚‹
- [x] `cdk synth` ãŒæ­£å¸¸ã«å®Œäº†ã™ã‚‹

---

## ä¸»è¦å®Ÿè£…é …ç›®

### cdk init ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *è¦ä»¶å®šç¾©æ›¸ REQ-401ã‚ˆã‚Š*

CDK v2 TypeScript ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã™ã‚‹ã€‚

```bash
mkdir aws-cdk-serverless-architecture
cd aws-cdk-serverless-architecture
cdk init app --language typescript
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ

---

### ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *è¨­è¨ˆæ–‡æ›¸ãƒ»CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š*

è¿½åŠ ã§å¿…è¦ãª CDK ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŠã‚ˆã³é–‹ç™ºãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```bash
npm install aws-cdk-lib constructs
npm install --save-dev @types/node typescript jest ts-jest @types/jest
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `package.json`

---

### parameter.ts ä½œæˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *è¨­è¨ˆæ–‡æ›¸ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ã‚ˆã‚Š*

ç’°å¢ƒåˆ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨è¨­å®šå€¤ã‚’å®šç¾©ã™ã‚‹ã€‚

```typescript
// parameter.ts
export interface EnvironmentConfig {
  envName: string;
  account: string;
  region: string;
  vpcCidr: string;
  taskCpu: number;
  taskMemory: number;
  desiredCount: number;
  auroraMinCapacity: number;
  auroraMaxCapacity: number;
  logRetentionDays: number;
  slackWorkspaceId: string;
  slackChannelId: string;
}

export const devConfig: EnvironmentConfig = {
  envName: 'dev',
  account: process.env.CDK_DEFAULT_ACCOUNT || '',
  region: 'ap-northeast-1',
  vpcCidr: '10.0.0.0/16',
  taskCpu: 512,
  taskMemory: 1024,
  desiredCount: 2,
  auroraMinCapacity: 0.5,
  auroraMaxCapacity: 2,
  logRetentionDays: 3,
  slackWorkspaceId: '',
  slackChannelId: '',
};

export const prodConfig: EnvironmentConfig = {
  envName: 'prod',
  account: process.env.CDK_DEFAULT_ACCOUNT || '',
  region: 'ap-northeast-1',
  vpcCidr: '10.0.0.0/16',
  taskCpu: 512,
  taskMemory: 1024,
  desiredCount: 2,
  auroraMinCapacity: 0.5,
  auroraMaxCapacity: 2,
  logRetentionDays: 30,
  slackWorkspaceId: '',
  slackChannelId: '',
};
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `parameter.ts`

---

### tsconfig.json è¨­å®š ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *CDK ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚ˆã‚Š*

TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©è¨­å®šã‚’é©åˆ‡ã«æ§‹æˆã™ã‚‹ã€‚

```json
{
  "compilerOptions": {
    "target": "ES2018",
    "module": "commonjs",
    "lib": ["ES2018"],
    "declaration": true,
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noImplicitThis": true,
    "alwaysStrict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": false,
    "inlineSourceMap": true,
    "inlineSources": true,
    "experimentalDecorators": true,
    "strictPropertyInitialization": false,
    "outDir": "./dist",
    "rootDir": "./"
  },
  "exclude": ["node_modules", "cdk.out"]
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `tsconfig.json`

---

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *è¨­è¨ˆæ–‡æ›¸ã‚ˆã‚Š*

è¨­è¨ˆæ–‡æ›¸ã«å¾“ã£ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆã™ã‚‹ã€‚

```
lib/
â”œâ”€â”€ stack/          # CDK Stack å®šç¾©
â”œâ”€â”€ construct/      # å†åˆ©ç”¨å¯èƒ½ãª Construct
â”‚   â”œâ”€â”€ vpc/
â”‚   â”œâ”€â”€ ecs/
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ security/
â”‚   â””â”€â”€ monitoring/
lambda/
â”œâ”€â”€ log_processor/
â””â”€â”€ custom_resource/
test/
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

---

## åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *CDK æ¨™æº–æ‰‹é †*

- `npm run build` ãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†ã™ã‚‹ã“ã¨
- TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒæˆåŠŸã™ã‚‹ã“ã¨

### CDK Synth ç¢ºèª ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *CDK æ¨™æº–æ‰‹é †*

- `cdk synth` ãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†ã™ã‚‹ã“ã¨
- CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨

---

## å®Ÿè£…æ‰‹é †

### DIRECTã‚¿ã‚¹ã‚¯ã®å ´åˆ

1. `/tsumiki:direct-setup` - ç›´æ¥å®Ÿè£…ãƒ»è¨­å®š
2. `/tsumiki:direct-verify` - å‹•ä½œç¢ºèªãƒ»å“è³ªç¢ºèª

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 5é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 5é …ç›® (100%)
- ğŸŸ¡ **é»„ä¿¡å·**: 0é …ç›® (0%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ª
